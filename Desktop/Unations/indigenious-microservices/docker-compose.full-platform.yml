version: '3.8'

# ==========================================
# INDIGENOUS PLATFORM - COMPLETE DEPLOYMENT
# 49 Microservices | 84 Features | Full Stack
# ==========================================

services:
  # ==========================================
  # CORE INFRASTRUCTURE
  # ==========================================
  
  postgres:
    image: postgres:16-alpine
    container_name: indigenous-postgres
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: indigenous2024
      POSTGRES_DB: indigenous_platform
    volumes:
      - postgres-data:/var/lib/postgresql/data
      - ./init-databases.sql:/docker-entrypoint-initdb.d/init.sql
    networks:
      - indigenous-network
    ports:
      - "5432:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 10s
      timeout: 5s
      retries: 5

  redis:
    image: redis:7-alpine
    container_name: indigenous-redis
    command: redis-server --appendonly yes --maxmemory 2gb --maxmemory-policy allkeys-lru
    volumes:
      - redis-data:/data
    networks:
      - indigenous-network
    ports:
      - "6379:6379"
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5

  rabbitmq:
    image: rabbitmq:3-management-alpine
    container_name: indigenous-rabbitmq
    environment:
      RABBITMQ_DEFAULT_USER: indigenous
      RABBITMQ_DEFAULT_PASS: indigenous2024
    ports:
      - "5672:5672"
      - "15672:15672"
    volumes:
      - rabbitmq-data:/var/lib/rabbitmq
    networks:
      - indigenous-network

  elasticsearch:
    image: elasticsearch:8.11.0
    container_name: indigenous-elasticsearch
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    volumes:
      - elasticsearch-data:/usr/share/elasticsearch/data
    ports:
      - "9200:9200"
    networks:
      - indigenous-network

  # ==========================================
  # CORE SERVICES (1-10)
  # ==========================================

  api-gateway:
    image: indigenous-api-gateway:latest
    build: ./indigenious-api-gateway
    container_name: indigenous-api-gateway
    ports:
      - "3000:3000"
    environment:
      NODE_ENV: production
      PORT: 3000
      REDIS_URL: redis://redis:6379
      JWT_SECRET: indigenous-secret-2024
    depends_on:
      - redis
    networks:
      - indigenous-network

  user-service:
    image: indigenous-user-service:latest
    build: ./indigenious-user-service
    container_name: indigenous-user-service
    ports:
      - "3001:3001"
    environment:
      NODE_ENV: production
      PORT: 3001
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  business-service:
    image: indigenous-business-service:latest
    build: ./indigenious-business-service
    container_name: indigenous-business-service
    ports:
      - "3002:3002"
    environment:
      NODE_ENV: production
      PORT: 3002
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  rfq-service:
    image: indigenous-rfq-service:latest
    build: ./indigenious-rfq-service
    container_name: indigenous-rfq-service
    ports:
      - "3003:3003"
    environment:
      NODE_ENV: production
      PORT: 3003
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  payment-service:
    image: indigenous-payment-service:latest
    build: ./indigenious-payment-service
    container_name: indigenous-payment-service
    ports:
      - "3004:3004"
    environment:
      NODE_ENV: production
      PORT: 3004
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  document-service:
    image: indigenous-document-service:latest
    build: ./indigenious-document-service
    container_name: indigenous-document-service
    ports:
      - "3005:3005"
    environment:
      NODE_ENV: production
      PORT: 3005
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  notification-service:
    image: indigenous-notification-service:latest
    build: ./indigenious-notification-service
    container_name: indigenous-notification-service
    ports:
      - "3006:3006"
    environment:
      NODE_ENV: production
      PORT: 3006
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
      RABBITMQ_URL: amqp://indigenous:indigenous2024@rabbitmq:5672
    depends_on:
      - postgres
      - redis
      - rabbitmq
    networks:
      - indigenous-network

  chat-service:
    image: indigenous-chat-service:latest
    build: ./indigenious-chat-service
    container_name: indigenous-chat-service
    ports:
      - "3007:3007"
    environment:
      NODE_ENV: production
      PORT: 3007
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  analytics-service:
    image: indigenous-analytics-service:latest
    build: ./indigenious-analytics-service
    container_name: indigenous-analytics-service
    ports:
      - "3008:3008"
    environment:
      NODE_ENV: production
      PORT: 3008
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
      ELASTICSEARCH_URL: http://elasticsearch:9200
    depends_on:
      - postgres
      - redis
      - elasticsearch
    networks:
      - indigenous-network

  compliance-service:
    image: indigenous-compliance-service:latest
    build: ./indigenious-compliance-service
    container_name: indigenous-compliance-service
    ports:
      - "3009:3009"
    environment:
      NODE_ENV: production
      PORT: 3009
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  # ==========================================
  # AI & INTELLIGENCE SERVICES (11-20)
  # ==========================================

  ai-core-service:
    image: indigenous-ai-core:latest
    build: ./indigenious-ai-core-service
    container_name: indigenous-ai-core
    ports:
      - "3010:3010"
    environment:
      NODE_ENV: production
      PORT: 3010
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  ai-intelligence-service:
    image: indigenous-ai-intelligence:latest
    build: ./indigenious-ai-intelligence-service
    container_name: indigenous-ai-intelligence
    ports:
      - "3011:3011"
    environment:
      NODE_ENV: production
      PORT: 3011
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  market-intelligence-service:
    image: indigenous-market-intelligence:latest
    build: ./indigenious-market-intelligence-service
    container_name: indigenous-market-intelligence
    ports:
      - "3012:3012"
    environment:
      NODE_ENV: production
      PORT: 3012
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  fraud-service:
    image: indigenous-fraud:latest
    build: ./indigenious-fraud-service
    container_name: indigenous-fraud
    ports:
      - "3013:3013"
    environment:
      NODE_ENV: production
      PORT: 3013
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  verification-service:
    image: indigenous-verification:latest
    build: ./indigenious-verification-service
    container_name: indigenous-verification
    ports:
      - "3014:3014"
    environment:
      NODE_ENV: production
      PORT: 3014
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  evaluation-service:
    image: indigenous-evaluation:latest
    build: ./indigenious-evaluation-service
    container_name: indigenous-evaluation
    ports:
      - "3015:3015"
    environment:
      NODE_ENV: production
      PORT: 3015
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  pipeline-service:
    image: indigenous-pipeline:latest
    build: ./indigenious-pipeline-service
    container_name: indigenous-pipeline
    ports:
      - "3016:3016"
    environment:
      NODE_ENV: production
      PORT: 3016
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  reporting-service:
    image: indigenous-reporting:latest
    build: ./indigenious-reporting-service
    container_name: indigenous-reporting
    ports:
      - "3017:3017"
    environment:
      NODE_ENV: production
      PORT: 3017
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  search-service:
    image: indigenous-search:latest
    build: ./indigenious-search-service
    container_name: indigenous-search
    ports:
      - "3018:3018"
    environment:
      NODE_ENV: production
      PORT: 3018
      ELASTICSEARCH_URL: http://elasticsearch:9200
      REDIS_URL: redis://redis:6379
    depends_on:
      - elasticsearch
      - redis
    networks:
      - indigenous-network

  recommendation-service:
    image: indigenous-recommendation:latest
    build: ./indigenious-recommendation-service
    container_name: indigenous-recommendation
    ports:
      - "3019:3019"
    environment:
      NODE_ENV: production
      PORT: 3019
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  # ==========================================
  # BUSINESS OPERATIONS (21-30)
  # ==========================================

  bonding-service:
    image: indigenous-bonding:latest
    build: ./indigenious-bonding-service
    container_name: indigenous-bonding
    ports:
      - "3020:3020"
    environment:
      NODE_ENV: production
      PORT: 3020
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  community-service:
    image: indigenous-community:latest
    build: ./indigenious-community-service
    container_name: indigenous-community
    ports:
      - "3021:3021"
    environment:
      NODE_ENV: production
      PORT: 3021
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  training-service:
    image: indigenous-training:latest
    build: ./indigenious-training-service
    container_name: indigenous-training
    ports:
      - "3022:3022"
    environment:
      NODE_ENV: production
      PORT: 3022
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  vendor-service:
    image: indigenous-vendor:latest
    build: ./indigenious-vendor-service
    container_name: indigenous-vendor
    ports:
      - "3023:3023"
    environment:
      NODE_ENV: production
      PORT: 3023
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  supplier-service:
    image: indigenous-supplier:latest
    build: ./indigenious-supplier-service
    container_name: indigenous-supplier
    ports:
      - "3024:3024"
    environment:
      NODE_ENV: production
      PORT: 3024
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  inventory-service:
    image: indigenous-inventory:latest
    build: ./indigenious-inventory-service
    container_name: indigenous-inventory
    ports:
      - "3025:3025"
    environment:
      NODE_ENV: production
      PORT: 3025
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  warehouse-service:
    image: indigenous-warehouse:latest
    build: ./indigenious-warehouse-service
    container_name: indigenous-warehouse
    ports:
      - "3026:3026"
    environment:
      NODE_ENV: production
      PORT: 3026
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  distribution-service:
    image: indigenous-distribution:latest
    build: ./indigenious-distribution-service
    container_name: indigenous-distribution
    ports:
      - "3027:3027"
    environment:
      NODE_ENV: production
      PORT: 3027
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  returns-service:
    image: indigenous-returns:latest
    build: ./indigenious-returns-service
    container_name: indigenous-returns
    ports:
      - "3028:3028"
    environment:
      NODE_ENV: production
      PORT: 3028
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  customer-service:
    image: indigenous-customer:latest
    build: ./indigenious-customer-service
    container_name: indigenous-customer
    ports:
      - "3029:3029"
    environment:
      NODE_ENV: production
      PORT: 3029
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  # ==========================================
  # COMMUNICATION & SUPPORT (31-40)
  # ==========================================

  email-service:
    image: indigenous-email:latest
    build: ./indigenious-email-service
    container_name: indigenous-email
    ports:
      - "3030:3030"
    environment:
      NODE_ENV: production
      PORT: 3030
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  sms-service:
    image: indigenous-sms:latest
    build: ./indigenious-sms-service
    container_name: indigenous-sms
    ports:
      - "3031:3031"
    environment:
      NODE_ENV: production
      PORT: 3031
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  push-notification-service:
    image: indigenous-push:latest
    build: ./indigenious-push-notification-service
    container_name: indigenous-push
    ports:
      - "3032:3032"
    environment:
      NODE_ENV: production
      PORT: 3032
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  feedback-service:
    image: indigenous-feedback:latest
    build: ./indigenious-feedback-service
    container_name: indigenous-feedback
    ports:
      - "3033:3033"
    environment:
      NODE_ENV: production
      PORT: 3033
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  help-service:
    image: indigenous-help:latest
    build: ./indigenious-help-service
    container_name: indigenous-help
    ports:
      - "3034:3034"
    environment:
      NODE_ENV: production
      PORT: 3034
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  video-service:
    image: indigenous-video:latest
    build: ./indigenious-video-service
    container_name: indigenous-video
    ports:
      - "3035:3035"
    environment:
      NODE_ENV: production
      PORT: 3035
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  voice-service:
    image: indigenous-voice:latest
    build: ./indigenious-voice-service
    container_name: indigenous-voice
    ports:
      - "3036:3036"
    environment:
      NODE_ENV: production
      PORT: 3036
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  file-storage-service:
    image: indigenous-file-storage:latest
    build: ./indigenious-file-storage-service
    container_name: indigenous-file-storage
    ports:
      - "3037:3037"
    environment:
      NODE_ENV: production
      PORT: 3037
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  cdn-service:
    image: indigenous-cdn:latest
    build: ./indigenious-cdn-service
    container_name: indigenous-cdn
    ports:
      - "3038:3038"
    environment:
      NODE_ENV: production
      PORT: 3038
      REDIS_URL: redis://redis:6379
    depends_on:
      - redis
    networks:
      - indigenous-network

  backup-service:
    image: indigenous-backup:latest
    build: ./indigenious-backup-service
    container_name: indigenous-backup
    ports:
      - "3039:3039"
    environment:
      NODE_ENV: production
      PORT: 3039
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  # ==========================================
  # INFRASTRUCTURE & MONITORING (41-49)
  # ==========================================

  cache-service:
    image: indigenous-cache:latest
    build: ./indigenious-cache-service
    container_name: indigenous-cache
    ports:
      - "3040:3040"
    environment:
      NODE_ENV: production
      PORT: 3040
      REDIS_URL: redis://redis:6379
    depends_on:
      - redis
    networks:
      - indigenous-network

  queue-service:
    image: indigenous-queue:latest
    build: ./indigenious-queue-service
    container_name: indigenous-queue
    ports:
      - "3041:3041"
    environment:
      NODE_ENV: production
      PORT: 3041
      REDIS_URL: redis://redis:6379
      RABBITMQ_URL: amqp://indigenous:indigenous2024@rabbitmq:5672
    depends_on:
      - redis
      - rabbitmq
    networks:
      - indigenous-network

  monitoring-service:
    image: indigenous-monitoring:latest
    build: ./indigenious-monitoring-service
    container_name: indigenous-monitoring
    ports:
      - "3042:3042"
    environment:
      NODE_ENV: production
      PORT: 3042
      REDIS_URL: redis://redis:6379
    depends_on:
      - redis
    networks:
      - indigenous-network

  logging-service:
    image: indigenous-logging:latest
    build: ./indigenious-logging-service
    container_name: indigenous-logging
    ports:
      - "3043:3043"
    environment:
      NODE_ENV: production
      PORT: 3043
      ELASTICSEARCH_URL: http://elasticsearch:9200
    depends_on:
      - elasticsearch
    networks:
      - indigenous-network

  auth-service:
    image: indigenous-auth:latest
    build: ./indigenious-auth-service
    container_name: indigenous-auth
    ports:
      - "3044:3044"
    environment:
      NODE_ENV: production
      PORT: 3044
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
      JWT_SECRET: indigenous-secret-2024
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  agent-monitoring-service:
    image: indigenous-agent-monitoring:latest
    build: ./indigenious-agent-monitoring-service
    container_name: indigenous-agent-monitoring
    ports:
      - "3045:3045"
    environment:
      NODE_ENV: production
      PORT: 3045
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  ambient-intelligence-service:
    image: indigenous-ambient-intelligence:latest
    build: ./indigenious-ambient-intelligence-service
    container_name: indigenous-ambient-intelligence
    ports:
      - "3046:3046"
    environment:
      NODE_ENV: production
      PORT: 3046
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  pr-automation-service:
    image: indigenous-pr-automation:latest
    build: ./indigenious-pr-automation-service
    container_name: indigenous-pr-automation
    ports:
      - "3047:3047"
    environment:
      NODE_ENV: production
      PORT: 3047
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  design-system-service:
    image: indigenous-design-system:latest
    build: ./indigenious-design-system-service
    container_name: indigenous-design-system
    ports:
      - "3049:3049"
    environment:
      NODE_ENV: production
      PORT: 3049
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
      PERFORMANCE_MODE: full-forest
      PHILOSOPHY: "Where Economics Meets The Land"
    depends_on:
      - postgres
      - redis
    networks:
      - indigenous-network

  # ==========================================
  # WEB FRONTEND
  # ==========================================

  web-frontend:
    image: indigenous-web-frontend:latest
    build: 
      context: ../
      dockerfile: Dockerfile
    container_name: indigenous-web-frontend
    ports:
      - "80:3000"
      - "443:3000"
    environment:
      NODE_ENV: production
      NEXT_PUBLIC_API_URL: http://api-gateway:3000
      NEXT_PUBLIC_WS_URL: ws://api-gateway:3000
      DATABASE_URL: postgresql://postgres:indigenous2024@postgres:5432/indigenous_platform
      REDIS_URL: redis://redis:6379
    depends_on:
      - api-gateway
      - postgres
      - redis
    networks:
      - indigenous-network

  # ==========================================
  # MONITORING & OBSERVABILITY
  # ==========================================

  prometheus:
    image: prom/prometheus:latest
    container_name: indigenous-prometheus
    volumes:
      - ./monitoring/prometheus:/etc/prometheus
      - prometheus-data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
    ports:
      - "9090:9090"
    networks:
      - indigenous-network

  grafana:
    image: grafana/grafana:latest
    container_name: indigenous-grafana
    volumes:
      - grafana-data:/var/lib/grafana
      - ./monitoring/grafana/provisioning:/etc/grafana/provisioning
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=indigenous2024
      - GF_INSTALL_PLUGINS=redis-datasource
    ports:
      - "3100:3000"
    networks:
      - indigenous-network

  portainer:
    image: portainer/portainer-ce:latest
    container_name: indigenous-portainer
    ports:
      - "9000:9000"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - portainer-data:/data
    networks:
      - indigenous-network

networks:
  indigenous-network:
    driver: bridge
    name: indigenous-network

volumes:
  postgres-data:
  redis-data:
  rabbitmq-data:
  elasticsearch-data:
  prometheus-data:
  grafana-data:
  portainer-data: